function [BW,maskedImage] = segmentImage(RGB)


% Convert RGB image into L*a*b* color space.
X = rgb2lab(RGB);

% Graph cut
foregroundInd = [46139 51153 206283 211318 211335 211336 211341 211344 211347 211350 211354 211356 211358 211361 211367 211372 212052 212055 212098 212099 213489 213490 213545 213549 214204 214271 214275 215639 215643 215716 215719 215722 215724 216353 216358 216447 216449 217890 217893 217895 217897 217906 217907 219352 219353 219354 219355 219358 219951 220078 220079 220080 220800 220802 222106 222109 222242 223545 224402 224404 224978 224980 225026 225027 225036 225038 225124 225137 227285 228017 228575 228725 229291 229399 229445 231526 231559 232167 232175 232337 232999 233048 233600 233768 233777 235760 236476 236491 236650 237194 237195 237319 237370 238634 238646 238756 238810 238817 240257 240970 240977 241509 241510 241513 241608 241617 241690 242948 243036 243130 243137 244400 244449 244450 244455 244507 245107 245147 245151 245290 245297 246547 246556 246563 246566 246574 246730 247267 247283 247448 247450 249605 249606 250867 250885 250886 251042 251045 251057 251612 251615 251618 251759 251760 251762 253029 253061 253066 253198 253216 254511 254590 255188 255236 255353 255354 255374 255959 256068 256073 257348 257403 257507 258788 258849 258850 258941 258942 258943 258946 259575 259653 259655 259656 259660 260295 260361 260362 260364 260365 260367 260369 260411 262389 262516 262518 263227 263229 263230 263231 263233 263821 263895 263943 263944 263945 264011 264550 264615 264658 264659 264660 264663 264664 264667 264669 264670 264731 266710 266831 266833 267555 267556 268278 268856 268999 271095 271161 271882 272602 272650 275354 275530 276833 276836 276837 276852 276927 278277 279674 279717 280437 281114 281147 281156 281249 281290 282554 282580 282581 282583 282585 282587 284045 284056 284715 284850 284851 284890 286126 286155 286186 286330 286875 287013 287050 288285 290528 290567 290615 291196 291261 291263 291264 291266 291267 291336 291371 294076 294216 294251 294796 294799 294874 294904 294936 294937 294940 295519 295520 295660 297744 297787 297820 297854 298362 298400 298466 298576 299080 299120 299163 299261 299297 299840 299956 299981 300017 302001 302116 302142 302177 302759 302862 302863 303397 303441 303586 304163 306277 306412 306441 306997 307045 307187 307765 307836 307876 307882 307908 307944 308483 308485 308491 308492 308577 310651 310652 310792 310825 311545 312080 312140 312178 312205 312232 312233 313520 313525 313708 314961 315150 315810 315834 315870 316352 316396 316412 316516 316521 316554 317834 317995 318030 319231 319415 319438 319470 320033 321433 321434 321598 321631 322172 322319 323590 323621 323625 323632 323741 323759 324479 325711 325748 325783 325792 325805 325952 326500 327980 328080 329344 330062 330063 330064 330103 330147 330228 330242 330276 330849 330898 330921 332218 332436 333658 334376 334498 334553 334565 334596 335068 335096 335238 337256 337374 337433 337445 337476 338165 338196 338769 338807 338886 339411 339538 339595 341545 341623 342303 343010 343063 343082 343084 343133 343156 343210 343236 343730 343814 343858 343930 343956 345888 346020 346743 346745 347301 347326 347393 347459 347478 347519 347531 347556 348138 348251 350206 350263 350344 350899 350972 350978 351131 351156 351619 351703 351842 353083 355243 355963 356111 356173 356196 357378 357635 358815 358843 358898 358900 358956 358995 359053 359075 359563 359612 359762 360975 361002 361109 361214 361232 361695 363391 364574 365374 365375 365451 365536 365537 365550 366202 367496 367710 368894 368974 369137 369811 369857 370524 370535 372737 373213 373311 373384 373457 373464 373465 374104 374162 374177 374179 374180 374182 374184 374708 376936 377059 377618 377625 377643 378302 378386 378451 378466 378499 379110 379116 379187 381133 381156 381380 381874 381876 382100 382573 382591 382594 382596 382606 382721 382764 382820 383311 383314 383448 383508 383540 385474 385668 386389 386912 386972 387109 387118 388511 388515 388549 389791 389817 390488 390511 390559 390742 391371 391395 391462 392671 394221 394240 394309 395033 396270 396411 396469 396472 396967 396990 397189 400563 400568 400639 400700 401288 401306 401544 402733 404162 404367 405040 405075 405144 407096 408499 409201 409224 409919 412254 412279 412344 412799 412820 412944 413021 413588 413618 413710 413784 414504 416524 416664 417341 417896 417970 418085 418086 418088 418104 418586 418805 420837 421704 422190 422424 422910 422911 422991 423082 423126 425157 425284 425304 425834 425915 426024 426511 426581 426609 426610 426627 426726 426744 427951 429561 431551 431578 431605 432271 432504 433710 433772 433896 434428 434616 434664 436104 436775 438025 438172 438211 439693 439704 440173 440181 440184 440221 440235 440251 440353 440371 440893 441134 442486 443950 443964 444487 444488 444489 444548 444700 444744 445206 445219 447366 447378 447379 447547 448130 448134 448809 448848 448850 448852 448984 449517 449529 449718 451689 451694 451944 452409 452498 453134 453188 453278 453329 453374 453848 454023 456103 456264 456727 456821 456823 457435 457447 457453 457454 457474 457543 458155 458167 458381 460327 460584 461773 461915 462024 463195 464891 465355 465366 465381 465622 466075 466086 466253 466331 466340 467768 468966 469834 469940 471276 471365 471366 471379 472082 473275 473447 473539 474012 474239 474259 475435 475452 475678 475699 476169 476419 477754 477859 479194 479195 479200 479299 479969 479992 480019 480739 482179 483538 483619 483620 483622 484076 484089 484263 484289 484306 484342 484344 484346 484348 484796 484943 485021 485070 487104 487836 487897 487902 487952 487955 488518 489129 489233 489398 489401 491389 491562 492173 492282 492812 492930 493002 493727 495596 495747 495888 496530 497036 497328 498548 498632 498638 498676 499917 500209 500812 501367 501369 501384 501396 501458 501636 502952 503076 504408 504516 504957 504967 504969 505131 505132 505133 506406 506409 506609 507401 508569 508666 508841 508854 509289 509487 510837 510842 511722 512882 514322 515041 515042 515323 515337 518924 519369 519494 519495 519496 519506 519534 519659 520089 520210 520254 520257 520379 522242 522387 522436 522962 523106 523247 523259 523682 523869 523875 524409 524525 524687 526859 527579 528009 528119 528189 528266 528270 528277 528281 528282 528299 528729 530889 531093 531735 532570 533049 533096 533097 533102 533108 533113 533286 535209 535256 535273 535358 535494 536094 536146 536164 536649 536930 538123 538185 538203 538238 539588 539594 540302 540466 540528 540969 540994 540997 541018 541115 541183 542432 542452 542498 542684 543871 543892 543894 544008 544066 544624 544627 546031 546074 546160 546172 546226 546283 546733 546751 546880 546935 548233 548236 548893 548960 548965 548966 549052 550351 550486 550487 550491 550601 551053 551318 552494 552511 552757 553934 554655 554794 554842 558255 558316 558992 559109 559159 559698 559944 561858 562102 562592 562759 562819 563371 563435 566414 566899 566948 567619 567756 567851 568357 568570 570730 570731 571329 571453 571940 571957 572177 572179 573440 573624 574821 575786 575790 576307 576315 576383 576468 576472 577889 577952 577956 579141 579926 580079 580116 581301 581479 582147 582198 582240 582281 582282 583483 583728 584227 584448 585624 585645 585703 585790 585796 585882 586407 586420 586421 586423 586509 587808 588042 588043 589945 589982 590025 590111 590165 590203 590204 590807 592141 592167 592273 592326 594265 594292 594327 594347 594412 594486 594527 594985 595014 595254 597145 597177 597229 597414 597865 597896 598005 598586 598588 598750 598855 599308 601735 602188 602190 602191 602221 602943 602948 603177 603777 605791 605840 606059 606664 607232 607279 607287 607294 607368 607385 607387 607389 607499 607982 608039 610252 611099 611582 611588 611589 611643 611674 611768 613090 613100 613140 613260 615877 616018 617344 619477 621128 623799 623828 625239 625361 626092 627402 627610 629562 629764 629765 632701 634012 634079 634085 634091 634141 634798 634853 634854 634857 637008 637014 637594 637685 638229 638289 638395 638405 638438 641306 642549 642713 642726 642731 642734 642781 645593 645605 646325 646383 646917 646943 648473 648484 648516 649882 650645 650648 650662 651359 651390 651392 654168 654227 654793 654942 654962 654998 656210 656278 656292 656294 656295 656312 656402 656438 656930 657054 658370 658394 658499 658549 658560 658584 659269 660530 660574 660720 661250 662690 662714 662762 662829 662880 662922 664130 664290 664320 664362 664852 664972 664990 665040 667162 669349 669362 669385 669402 672054 672073 672232 672776 672915 672988 673496 673635 673684 674216 674243 674337 676564 676602 677126 677322 677993 678004 678032 678035 678036 678037 678676 680702 680734 680737 680836 680875 681556 681604 682863 682984 683044 685022 685204 685743 685875 685924 686464 687907 688051 688084 689344 689397 689524 690117 690300 690788 690937 690964 692381 692399 693900 694388 694560 694562 694620 695944 695965 696000 696002 696060 696548 696780 698037 698142 699586 700149 700197 700917 700919 702392 702451 703750 703753 703815 703824 703826 703907 704627 704638 705193 705194 705325 707354 707580 708073 708074 708794 708795 708796 708921 708971 712521 712620 713213 714060 717440 717489 720319 720540 721156 721171 721760 721823 721826 721836 721980 723200 723315 724641 725361 726081 726297 727655 727737 728965 729851 731123 731140 731152 731335 731878 733283 733401 735533 735654 736163 736204 739858 739973 740578 740591 741923 741969 742018 743458 744083 744293 744904 747173 747791 748405 748450 748529 748531 748541 748553 748554 748555 748558 748613 749125 749279 749333 751439 751457 752006 752874 752879 752930 753599 755606 755810 757250 758487 758690 760079 760130 760737 761369 761570 763010 765010 765051 766411 767330 768770 769291 769330 769367 769490 770731 770770 770775 770776 771451 771490 773089 774331 774376 774461 774529 775051 775249 775771 775896 775968 777211 778696 778715 779372 779490 779497 779537 782252 782362 782375 782974 783695 783750 784415 784499 784507 786616 786635 786641 786651 787346 787347 787349 788110 788174 788197 788894 788917 790987 791076 791707 791796 792343 792376 792491 792515 793063 793065 795225 795395 796044 796085 796696 796775 796792 796793 796799 796804 798107 799547 799688 799711 800989 801016 801151 804031 804591 804627 804724 806031 806072 806191 806796 808238 809071 810352 810402 810511 811072 812671 814111 816833 816991 818431 818996 819828 821944 822031 822597 823390 823426 823471 824037 826278 826351 826917 827002 827023 827071 827637 827725 827735 827736 827741 827742 827791 828358 828511 831239 831242 831963 831965 832111 833408 833409 833551 834850 835574 835576 836296 836298 836301 836303 836304 837747 839187 839311 839914 841356 841360 842190 843526 843527 843630 844248 845691 845693 845694 845697 845788 845790 846420 846423 846508 847870 847873 847876 847881 847882 847885 847887 847946 849329 849333 849340 849341 850061 850067 850068 850069 850073 850074 850105 850800 850805 850824 852251 852253 852264 853697 853699 853700 853702 ];
backgroundInd = [9247 9250 9262 9266 9267 11400 11437 11937 11940 11949 11953 11980 11989 12110 12159 12646 12768 12770 12890 15616 15784 15789 16342 16350 16351 16361 16374 16391 16410 17204 17235 17241 17246 18375 18628 18687 19950 20117 20694 20780 21233 21239 21490 21569 22824 22854 23009 25025 25045 26059 26071 26078 26092 26104 26607 28329 28724 28772 29060 29071 29291 29449 29492 30354 30536 30548 30554 30768 30893 31071 31072 31488 33047 33050 33064 33089 34483 34496 34505 35199 35200 35242 35243 35863 35961 38049 38078 38645 38841 38843 39395 39561 39569 39700 40110 42575 43138 43175 43895 44459 44603 46761 47053 47608 47726 48178 48324 48520 48800 48926 48935 51203 51660 52028 52318 52334 52489 52490 52538 53620 54797 54798 54896 55021 55205 55744 55754 56121 56474 56732 58069 58201 58226 60392 60397 60436 60437 61779 61790 61838 61876 61880 62600 63520 64036 64663 64761 65675 65986 66152 66310 66706 66922 67828 68319 69746 69778 69801 69820 70423 71032 71186 72070 72639 72676 74102 74107 74109 74111 74599 74754 74780 74818 74833 74835 74836 75519 77671 78613 78990 79075 81943 81998 82733 82931 83382 83389 83390 83437 83455 84134 85746 85811 86107 86263 86531 87257 87727 87753 88312 88383 88389 88418 90143 90286 90528 90529 90534 90537 90559 90682 91003 91335 91352 91588 91901 92145 93150 93487 93538 94921 94940 96344 96363 96436 97356 98899 99301 99323 100053 101302 101431 101462 105367 105806 106548 109428 109503 110023 110562 112820 114448 114449 114452 116948 116965 116975 117119 117302 117351 118071 118142 118258 118302 118311 118323 118328 118363 118750 121165 121317 122003 122591 122616 123055 123065 123111 123113 123454 123837 125464 125550 125929 125991 126570 127395 127418 127440 128880 130276 130320 130524 131013 131414 131484 131673 131760 133145 134546 134612 136582 136761 136800 137175 137489 137520 139402 139404 139648 139680 141120 141465 141726 141831 141833 143188 143274 144711 144714 145095 145228 145316 145341 145431 146052 147508 147547 149096 149293 149342 149726 150388 150446 152535 152551 152628 153326 153717 153728 153960 153994 153997 154074 154601 156884 156926 157604 157928 157970 158043 158294 158325 159113 162335 162607 162609 162650 162667 162705 163406 165042 165226 165531 166286 166567 167006 169569 170241 170289 170576 171729 172016 172018 172449 172741 173836 174207 174555 174950 176045 176363 176388 178204 179839 180363 180706 181023 181083 181413 182827 182831 184165 184293 184679 184947 185014 185015 185018 185091 187497 187558 188277 188603 188934 188997 189175 189290 189654 190059 192167 192593 193177 193313 193335 193338 193340 193341 193344 193346 193350 193352 193354 193361 193365 193372 193377 193383 193398 193542 193646 194031 194049 194050 194054 194055 194122 194127 194264 194342 194379 196191 196208 196232 196234 196290 196507 196911 196922 196923 197011 197149 197230 197559 197627 197629 197676 197678 197680 197681 197733 197736 197869 197953 198277 198347 198401 198402 198405 198406 198456 200567 200568 200571 200572 200620 200803 200928 201226 201293 201294 201297 201298 201470 201945 202020 202023 202024 202027 202030 202031 202033 202035 202039 202042 202045 202049 202051 202057 202060 202061 202068 202072 202073 202135 202232 202243 202287 202299 203167 203502 203630 203707 203709 204825 205149 205545 205867 205869 205870 206185 206265 206540 206590 206591 206619 207827 207870 208007 208033 208035 208925 209061 209143 209310 209311 209450 209453 209455 209499 209514 209779 209863 210031 210032 210035 211005 211429 211432 211476 211477 211478 211580 211647 211658 212021 212153 212154 212155 212158 212198 212314 212375 213348 213458 213460 213599 213600 213602 213604 213605 213606 213608 213610 213611 213613 213616 213617 213620 213624 213625 213626 213642 213655 213815 214092 214362 214529 214532 214553 215526 215615 215802 215900 215975 216241 216326 216327 216511 216522 216694 217677 217679 217760 217761 217952 217962 219392 219395 219573 219591 219645 219773 219916 219919 220116 220220 220293 220836 220843 221885 221988 222075 222276 222342 222471 223424 224144 224436 224443 224613 224953 225156 225164 227019 227684 227737 228097 228456 228549 228756 228764 228786 229484 231428 231636 232051 232148 232356 232770 232867 233076 233084 233222 233796 233973 235601 235956 235964 236044 236321 236676 236684 237089 237391 237396 237476 238481 238529 238830 238836 238844 239973 240062 240270 240271 240284 240355 240990 240991 241004 241185 241502 241710 241763 241766 241790 243151 243211 244381 244596 245098 245310 246444 246537 246750 246764 247089 247256 247257 247470 248910 248924 249630 250854 251070 251071 251076 251280 251438 251796 251804 253014 253230 254670 254671 254684 255038 255172 255390 255439 255892 256124 257550 257556 257564 257759 258991 258996 259039 259490 259491 259710 259711 259716 260124 260430 260431 260436 262596 262780 263316 263324 263681 263686 263706 263724 264031 264035 264044 264237 264530 264750 264755 266923 267324 267630 268350 268363 268846 269070 269083 271230 271243 271279 271950 272445 272670 272683 272847 273439 275550 275563 276270 276283 276320 276760 276988 277003 277197 278430 278435 279868 279883 280586 280590 280595 280603 280797 280863 280865 280866 281077 281306 281310 281315 282302 282312 282314 282517 282746 282756 282889 283739 284186 284196 284203 284251 284677 284910 284916 284923 286116 286346 286350 286352 286356 286636 287066 287072 287277 288506 288512 288516 288523 288579 289226 289232 289236 289243 290237 290434 290666 290672 290675 290684 291152 291386 291407 292397 292591 292826 292836 294268 294270 294276 294277 294990 294991 294996 294997 295008 295167 295251 295711 295716 295728 297872 297877 297888 298350 298595 298597 298608 299068 299316 299317 299318 299328 299329 299493 299579 300036 300038 300049 300123 301762 302198 302210 302482 302666 302917 302918 302930 303203 303324 303386 303638 303641 303650 303726 303833 304105 304106 304361 304447 307242 307243 307244 307253 307403 307503 307973 308049 308248 308305 308364 308792 308871 310853 310929 311573 311649 311849 312021 312293 312294 312295 312449 313734 314900 315174 315406 315900 315901 316339 316614 316621 316731 317566 317724 317779 318066 319494 320214 321379 321654 322374 322391 323539 323814 324534 325530 325974 325994 326786 328134 329740 329806 330014 330294 330459 331014 331169 333894 334333 334614 334731 334769 334772 334773 334774 334775 334778 335361 337116 337212 338214 338215 338448 338649 338935 341843 342248 342656 342658 342810 342967 343687 344005 345847 346137 346200 346251 346859 346978 347090 347202 347286 347690 348006 350166 351180 351298 351603 351900 351925 352851 353043 353340 355202 355500 356220 356325 357660 357764 358801 359125 359331 359820 360961 361260 361285 361681 362005 363420 363445 364408 364860 364885 365277 365605 365996 365997 366300 366325 366404 367765 368876 369596 369900 370315 370723 372780 372805 373195 373526 373884 374208 374209 374210 374213 374215 374219 374223 374225 374228 374234 374351 374633 374928 374940 374955 377088 377100 377123 377125 377126 377513 377808 377820 377875 377878 378528 378540 378598 378600 381113 381408 381419 381804 381833 382128 382524 382553 382921 383265 383709 385425 385427 385728 385970 386007 386145 386147 386448 386457 386867 387168 387177 388283 388307 388738 390048 390443 390768 391160 391182 391495 391561 394062 394368 394375 395088 395095 395200 396225 396529 396535 396594 396603 396807 398689 398825 399113 399409 399415 400518 400553 400850 400854 400855 400924 401693 404450 405170 405307 405893 406997 407406 408846 409001 409494 409567 409622 409927 410272 410342 412007 412087 412374 412754 412806 412807 413094 413199 413526 413527 413814 413892 414242 414243 416401 416403 416694 416774 417121 417414 417839 417842 418135 418264 418561 420721 421015 421039 421437 421735 422087 422156 422159 422161 422455 422678 422824 423256 425011 425037 425335 425757 426055 426421 426475 426775 426791 427860 428264 428296 430075 431315 431460 431511 431815 432211 432233 432537 433650 433651 433670 433977 434338 434370 434390 434393 434697 435810 435811 435831 436137 436139 436496 436529 436548 436859 437969 437970 437987 438300 439409 439425 439427 439745 439777 440129 440142 440144 440148 440460 440849 440862 441180 441213 442255 442289 442302 442308 442621 443693 443723 443729 443730 443742 443747 444061 444092 444462 444464 444465 444467 444468 444470 444781 444785 444811 445187 445503 445531 447329 447351 447663 448071 448383 448386 448769 448791 448793 449103 449106 449109 449111 449114 449825 449936 451612 451649 451675 451986 452359 452395 452706 452918 453050 453115 456715 457239 457364 457405 457746 457838 458155 460277 460628 461004 461035 461348 461724 461725 461755 462068 463130 463164 464633 465290 465324 465668 466010 466044 466388 467513 467895 468892 468924 468953 469988 471084 471111 471428 471523 471533 471803 471830 473085 473244 473963 473965 475372 475405 475427 475428 475840 475965 476092 476120 477553 477585 477906 478999 479346 479675 479726 479742 480158 480439 480462 481886 483319 483773 484033 484386 485199 487358 487639 488359 488366 488706 489099 491233 491259 491586 491935 491959 491979 492306 492526 492679 493026 493028 493133 495536 495559 495906 496016 496626 496629 496999 497019 497346 497348 497349 497351 498286 498459 498788 499879 500228 500599 500948 500949 501166 501300 501317 501324 501339 501671 502606 503111 504203 504204 506364 506712 506928 507432 508524 508872 509592 510679 510684 510702 511399 511424 511752 512839 512864 513247 514211 514279 514285 514304 514632 514999 515022 515024 515352 515596 517158 517159 517184 517512 518624 518627 518952 519318 519319 519329 519344 519347 519348 519672 520039 520049 520068 522200 522228 522944 522948 523494 523496 523640 523643 523664 523670 523994 523995 523997 523999 524001 524003 524047 524360 524363 524384 524391 524393 526544 526553 527244 527251 527264 527275 527964 527971 527995 528684 530844 530845 530876 531422 531565 532142 532143 532183 532285 532286 532289 532316 533009 535055 535165 535170 535891 536335 536470 536472 536613 536615 537004 537018 538456 538465 539496 540216 540217 540626 540749 540939 540941 542189 543633 543822 544349 544927 544929 544975 545789 545982 546364 546367 548142 548155 548875 550278 550291 550315 551035 552451 552475 553724 553904 553915 553916 553917 554624 554637 555149 555331 555355 556605 556795 556801 558032 558198 558224 558235 558241 558918 558944 558945 558961 558962 559488 559665 559667 559675 559683 561813 561815 561827 561828 561835 561843 562227 562548 562555 562563 563238 563256 563257 563268 563275 563286 563287 563667 563981 563982 563988 563990 563995 565955 566148 566150 566151 566153 566155 566546 566691 566871 567266 567593 567595 567607 567986 568278 568315 568327 568706 568707 570475 570487 571195 571715 571916 571917 571928 573359 573361 573368 574801 574808 575315 575331 575485 575490 575491 575495 575496 575521 575528 575529 576217 576222 576235 576236 576241 576249 577639 577689 579079 579129 579535 579849 581289 582012 583452 584172 585563 585612 585613 586333 587773 589164 589213 589933 589934 592045 592094 594255 594753 594975 595367 598529 598578 598855 601855 602899 604015 605730 605779 606451 607219 610819 611216 611308 611539 612931 615139 615627 615640 615811 615859 616226 618507 619260 621570 621615 622817 623426 623560 624146 624968 625170 625213 628600 628769 629489 629902 629933 630210 632370 634135 634970 637446 638136 641016 641041 642187 642459 646507 649481 649675 651115 651525 652553 652965 654708 654713 655961 656153 656587 660471 660473 660850 661604 662633 663009 665167 665947 673959 677730 677733 677755 677766 678185 678278 678450 680610 682059 682088 682438 684933 684972 686413 687854 689294 690018 690738 691072 692179 695753 695780 696500 697712 697915 698265 700138 700424 700589 700796 700858 702236 702296 702297 702298 703704 703723 703736 703738 704425 704443 704456 704458 704743 704819 705165 705176 705178 707068 707277 707336 707622 708045 708046 708058 708339 708748 708768 708778 709058 709059 709486 709494 711630 712381 713070 713088 713094 713102 713814 713822 715982 716641 716643 716702 717147 717408 717410 717411 717414 717422 717867 718130 718131 718134 718491 720292 720304 721012 721024 721359 721731 721732 721734 721744 721747 723156 723176 723187 724605 724606 724608 724627 725336 725348 725684 725685 725787 725979 726040 726042 726057 726068 727419 727508 727843 728920 729579 729637 729658 729668 731019 731083 731108 731812 731828 732987 733179 733261 733598 733966 733988 735408 735410 735428 736087 736130 736134 736142 736148 737582 737588 737837 739011 739028 739274 739275 739277 739468 739662 739687 739736 739743 739748 739992 739997 740078 740188 740456 740468 740717 741882 741897 741903 741908 742152 743264 743265 743343 743348 743677 744042 744063 744068 744069 744317 744397 744777 744778 744784 744789 745119 745162 746892 746944 746949 747189 747279 747321 747322 747612 747657 747667 747908 747909 747915 748112 748307 748317 748327 748333 748387 748388 748723 748761 749102 749108 749346 749355 750993 751268 751269 751506 751929 751933 751940 751989 752226 752234 752433 752440 752710 752713 752946 752954 753047 753080 753433 753666 753759 755522 755588 755593 755826 755834 756242 756259 756308 756313 756546 756548 756549 756551 756554 756955 756979 757030 757034 757271 758390 758445 758470 758474 758711 758712 759633 759837 759914 760151 760280 760556 760557 760605 760634 760872 761073 761305 761306 761323 761326 761328 761330 761331 761332 761336 761338 761343 761344 761347 761354 761591 761592 762751 762756 762760 762788 763031 763032 764228 764229 764949 764950 765192 766113 766332 766362 766390 766393 766833 767113 767351 767352 767458 768242 768553 768554 768791 769195 769248 769274 769511 769635 770433 770714 770949 771367 771434 771781 772874 774034 774290 774314 774753 774754 775010 775034 775266 775369 775381 775389 775390 775701 775754 775986 778866 778872 778990 779355 779709 780305 780419 782235 782463 782472 783183 783656 783676 783901 784352 784620 784621 784749 786536 786556 786896 786907 787616 787619 787977 787999 788232 788336 788347 788697 788719 788939 790840 791111 791215 791599 791600 791817 791831 791935 791936 791947 792283 792537 792655 792665 793003 793022 793385 795203 795414 795431 795545 795925 796134 796973 796985 798293 798308 799526 800246 800888 801169 801170 802351 804048 804049 804786 804805 805987 806006 806208 806226 806245 806727 806928 806965 808105 808148 808169 808368 808386 808405 808889 808891 808892 809221 810308 810334 810335 810528 810546 810565 810661 811055 811057 811058 811248 811281 811283 812498 813938 813940 814160 814163 814258 814661 814880 814978 815381 815568 815599 815603 816789 816821 817008 817028 817043 818261 818448 818468 818479 818656 818894 818981 819168 819186 819188 819203 819295 819670 819906 821774 821861 821863 822048 822066 822068 822896 823273 823305 823488 823506 823610 823611 823994 824025 824208 826368 826386 826395 826496 827088 827106 827114 827595 827625 827808 827843 827925 828346 828563 830506 830697 830706 831227 831408 831426 831445 831839 831843 831848 831923 831947 832127 832146 832148 832152 832170 832171 832172 832173 832176 832177 832256 833294 833295 833363 833387 833567 833592 833605 833606 833607 833610 834738 834806 834827 835004 835031 835446 835455 835549 835724 836159 836179 836444 836448 836450 836468 836469 836576 837711 837884 837906 837908 837992 838018 838019 838021 838022 838024 838027 838036 838042 839055 839131 839151 839324 839346 839348 839482 839872 839873 839876 839877 839878 839879 839882 839883 839884 840044 840148 840202 841325 841328 841484 841500 841501 841506 842048 842049 842204 842226 843489 843490 843644 843657 843666 843802 844101 844210 844212 844214 844364 844367 844374 844375 845655 845656 845804 845807 845814 845826 846376 846378 846527 846616 847459 847820 847964 847969 849145 849218 849261 849264 849266 849267 849269 849270 849404 849407 849408 849409 849492 849556 849619 849847 849858 849866 849938 849992 849994 850127 850128 850210 850276 850569 850716 850718 850720 850848 850924 852036 852160 852288 852430 853452 853600 853601 853602 853728 853869 854186 854188 854190 854203 854322 854325 854326 854327 854448 854900 854908 854910 855047 855048 855168 856819 857104 857107 857108 857208 857211 857328 857395 857396 857785 857791 857805 857828 857928 857931 857932 857933 857934 857938 857939 857940 857943 857944 858048 858115 858510 858511 858664 858665 858667 858669 858670 858763 858764 858767 858768 858901 858902 859269 859391 859393 859395 859483 861408 861642 861779 862276 862278 862279 862281 862356 862358 862361 863001 863002 863004 863005 863007 863009 863010 863011 863013 863015 863016 863017 863020 863022 863023 863026 863027 863028 863029 863032 863033 863034 863038 863039 863040 863042 863044 863057 863062 863064 863070 863075 863131 863560 863764 863765 863776 863845 865720 866599 866602 866604 866605 866607 866609 866610 866611 866899 867190 867316 867319 867331 867415 867531 868036 868055 868129 868134 870028 870196 870215 870217 870228 870233 870257 870264 870499 870794 870916 871127 871490 871514 871636 871844 873101 873102 874341 874400 874516 874541 874713 875123 875236 875847 875976 875982 876148 877243 878734 878836 878838 880735 880740 880760 880781 880790 880845 880999 881011 881166 881167 881562 881722 883002 883073 883162 883169 883315 883316 883723 883882 884032 884891 884991 884998 885000 885005 885011 885166 885243 885322 885324 885841 888776 889257 889263 889479 889508 889509 889529 889594 889746 889759 889766 889922 889927 889935 889948 889965 890155 890212 890273 890320 890322 890447 890449 892376 892571 892576 893028 893030 893170 893180 893194 893282 893748 893750 893751 893792 893889 893921 893927 893983 893998 894664 894697 894703 896671 896683 896686 896702 896708 896720 896723 896725 897391 897394 897397 897443 898087 898178 898808 898812 898813 898818 901077 901694 901810 901816 901845 901860 901867 903330 903331 906202 906209 906210 906713 906930 906935 906937 906940 908151 908316 908365 910308 911178 911187 911242 914009 914011 914012 914018 914021 914116 914737 914783 916270 918424 918425 918427 ];
L = superpixels(X,4708,'IsInputLab',true);

% Convert L*a*b* range to [0 1]
scaledX = prepLab(X);
BW = lazysnapping(scaledX,L,foregroundInd,backgroundInd);

% Clear borders
BW = imclearborder(BW);

% Create masked image.
maskedImage = RGB;
maskedImage(repmat(~BW,[1 1 3])) = 0;
end

function out = prepLab(in)

% Convert L*a*b* image to range [0,1]
out = in;
out(:,:,1) = in(:,:,1) / 100;  % L range is [0 100].
out(:,:,2) = (in(:,:,2) + 86.1827) / 184.4170;  % a* range is [-86.1827,98.2343].
out(:,:,3) = (in(:,:,3) + 107.8602) / 202.3382;  % b* range is [-107.8602,94.4780].

end
